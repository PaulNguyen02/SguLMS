CREATE DATABASE SGUEDU;
USE SGUEDU;

CREATE TABLE LOP(
	MALOP CHAR(10),
    KHOA  CHAR(10),
    NIENKHOA VARCHAR(80),
	SISO INT,
    CVHT NVARCHAR(55),
    PRIMARY KEY(MALOP)
);

CREATE TABLE KHOA(
	MAKHOA CHAR(10),
	TENKHOA NVARCHAR(55),
    TRUONGKHOA NVARCHAR(55),
    PHONG VARCHAR(15),
    SDT CHAR(10),
    PRIMARY KEY(MAKHOA)
);

CREATE TABLE THONGTINCANHAN(
	MASO CHAR(10),
	HOTEN NVARCHAR(100),
    NGAYSINH DATE,
    DIACHI NVARCHAR(150),
    LOP CHAR(10),
	NGANH NVARCHAR(55),
    KHOA CHAR(10),
    NIENKHOA VARCHAR(55),
    HINHANH TEXT,
    MATKHAU VARCHAR(15),
    QUYEN BIT,
    PRIMARY KEY(MASO),
    FOREIGN KEY (LOP) REFERENCES LOP(MALOP),
    FOREIGN KEY (KHOA) REFERENCES KHOA(MAKHOA)
);

CREATE TABLE THONGBAO(
	STT INT auto_increment,
	NGAYCHINHSUA DATETIME,
	TIEUDE NVARCHAR(55),
	NOIDUNG NVARCHAR(300),
    MASO CHAR(10),
    PRIMARY KEY (STT),
    FOREIGN KEY (MASO) REFERENCES THONGTINCANHAN(MASO)
);

CREATE TABLE LICHTHI
(
	STT INT auto_increment,
    MAMH INT,
    TENMH NVARCHAR(150),
    SISO INT,
    NGAYTHI DATE,
    GIOBD TIME,
    PHONGTHI VARCHAR(5),
    COSO CHAR,
    PRIMARY KEY (STT)
);

CREATE TABLE CTLICHTHI(
	STT INT auto_increment,
	MASO CHAR(10),
    STTPHONGTHI INT,
    TENSV NVARCHAR(100),
    PRIMARY KEY (STT, MASO),
	FOREIGN KEY (STT) REFERENCES LICHTHI(STT),
	FOREIGN KEY (MASO) REFERENCES THONGTINCANHAN(MASO)
);

CREATE TABLE MONHOC(
	MAMH CHAR(6),
	TENMH NVARCHAR(150),
	NHOM INT,
    SISO INT,
    STC INT,
    LOP CHAR(10),
    THU NVARCHAR(8),
    TIETBD INT,
    SOTIET INT,
    PHONG VARCHAR(5),
    GIANGVIEN NVARCHAR(100),
    TUANBD INT,
    HOCPHI FLOAT,
    KHOA CHAR(10),
    THUCHANH BIT,
    ISSELECTED BIT,
    PRIMARY KEY (MAMH,NHOM,THUCHANH),
    FOREIGN KEY (KHOA) REFERENCES KHOA(MAKHOA) 
);

CREATE TABLE NIENKHOAHOCKY(
	STT INT auto_increment,
	HOCKY INT,
    TGBATDAU DATE,
    TGKETTHUC DATE,
    NIENKHOA NVARCHAR(35),
    HPCHUAGIAM FLOAT,
    HPMIENGIAM FLOAT,
    HPPHAITHU FLOAT,
    HPDATHU FLOAT,
    HPCONNO FLOAT,
    PRIMARY KEY (STT)
);

CREATE TABLE DIEM (
	MAMH CHAR(6), 
    MASO CHAR(10),
    STT INT,
    THUCHANH BIT,
	DIEMQUATRINH10 FLOAT,
	DIEMCUOIKY10 FLOAT,
    DIEMTONGKET10 FLOAT,
    DIEMTONGKET4 FLOAT,
    XEPLOAI CHAR,
    KETQUA BIT,
    PRIMARY KEY (MASO, MAMH, STT ,THUCHANH),
    FOREIGN KEY (MASO) REFERENCES THONGTINCANHAN(MASO),
    FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH),
    FOREIGN KEY (STT) REFERENCES NIENKHOAHOCKY(STT)
);

CREATE TABLE YKIEN(
	STT INT auto_increment,
    THOIGIAN DATETIME,
    TIEUDE NVARCHAR(150),
    NOIDUNG NVARCHAR(550),
	MASO CHAR(10),
    PRIMARY KEY (STT),
	FOREIGN KEY (MASO) REFERENCES THONGTINCANHAN(MASO)
);

CREATE TABLE CTNKHK(
	MSSV CHAR(10),
	STTNKHK INT,
    DIEMQTHE10 FLOAT,
    DIEMQTHE4 FLOAT,
    HPDADONG FLOAT,
    PRIMARY KEY (MSSV, STTNKHK),
    FOREIGN KEY (MSSV) REFERENCES THONGTINCANHAN(MASO),
    FOREIGN KEY (STTNKHK) REFERENCES NIENKHOAHOCKY(STT)
);

CREATE TABLE TAILIEU(
	STT INT auto_increment,
	TIEUDE NVARCHAR(150),
	NGAYDANG DATE,
    LINKTAI TEXT,
    MASO CHAR(10),
    PRIMARY KEY (STT),
    FOREIGN KEY (MASO) REFERENCES THONGTINCANHAN(MASO)
);

INSERT KHOA VALUES 
('CNTT','CÔNG NGHỆ THÔNG TIN','PHẠM THẾ BẢO','C301','093765365'),
('TCKT','TÀI CHÍNH KẾ TOÁN','LÊ HUYỀN TRÂN','C205','098376622'),
('DTVT','ĐIỆN - ĐIỆN TỬ','TRẦN TUẤN NGỌC','C305','099875764'),
('NNDL','NGOẠI NGỮ - DU LỊCH','LÊ TUẤN MINH','C203','099984742'),
('LUXH','LUẬT - XÃ HỘI HỌC','NGUYỄN THANH TRÚC','C201','093764543');

INSERT LOP VALUES 
('DCT1201','CNTT','2020-2025',43,'LÃNG PHIÊU'),
('DCT1203','CNTT','2020-2025',45,'NGỌC LOAN'),
('DCT1204','CNTT','2020-2025',40,'TẤN KHOA'),
('DCT1205','CNTT','2020-2025',35,'TUẤN ĐĂNG'),
('DCT1207','CNTT','2020-2025',40,'THẾ BẢO'),
('DCT1209','CNTT','2020-2025',50,'HỒNG ANH'),
('DCT12010','CNTT','2020-2025',55,'HỮU TRÍ'),
('DKE1201','DTVT','2020-2025',35,'MINH TRÍ'),
('DAN1203','NNDL','2020-2025',50,'NGỌC ANH'),
('DNT1205','TCKT','2020-2025',55,'QUỐC CƯỜNG'),
('LUX1208','LUXH','2020-2025',45,'THẢO MY');

INSERT MONHOC VALUES
('841020','CƠ SỞ LẬP TRÌNH',1,45,3,'DCT1204','NĂM',1,3,'A302','NGUYỄN NHỰT ĐÔNG',1,1110000,'CNTT',0,0),
('841020','CƠ SỞ LẬP TRÌNH',1,45,3,'DCT1204','NĂM',4,2,'A107','NGUYỄN NHỰT ĐÔNG',1,1110000,'CNTT',1,0),
('841303','KỸ THUẬT LẬP TRÌNH',2,40,4,'DCT1206','SÁU',1,2,'E105','PHAN TẤN QUỐC',1,1480000,'CNTT',0,0),
('841303','KỸ THUẬT LẬP TRÌNH',2,40,4,'DCT1206','SÁU',3,2,'A108','PHAN TẤN QUỐC',1,1480000,'CNTT',1,0),
('841021','KIẾN TRÚC MÁY TÍNH',3,50,3,'DCT1205','TƯ',1,2,'E102','NGUYỄN TẤN CÔNG',1,1110000,'CNTT',0,0),
('841021','KIẾN TRÚC MÁY TÍNH',3,50,3,'DCT1205','TƯ',3,2,'A105','NGUYỄN TẤN CÔNG',1,1110000,'CNTT',1,0),
('841403','CẤU TRÚC RỜI RẠC',4,50,4,'DCT1205','TƯ',6,2,'E106','PHẠM THẾ BẢO',1,1480000,'CNTT',0,0),
('841403','CẤU TRÚC RỜI RẠC',4,50,4,'DCT1205','TƯ',8,2,'A109','PHẠM THẾ BẢO',1,1480000,'CNTT',1,0),
('841108','CẤU TRÚC DỮ LIỆU VÀ GIẢI THUẬT',1,50,4,'DCT1208','BA',3,2,'E106','PHAN TẤN QUỐC',1,1480000,'CNTT',0,0),
('841108','CẤU TRÚC DỮ LIỆU VÀ GIẢI THUẬT',1,50,4,'DCT1208','BA',1,2,'A106','PHAN TẤN QUỐC',1,1480000,'CNTT',1,0),
('841404','MẠNG MÁY TÍNH',1,50,3,'DCT1208','HAI',4,2,'E106','BÙI CÔNG GIAO',1,1110000,'CNTT',0,0),
('841404','MẠNG MÁY TÍNH',1,50,3,'DCT1208','HAI',6,2,'A106','BÙI CÔNG GIAO',1,1110000,'CNTT',1,0),
('841044','LẬP TRÌNH HƯỚNG ĐỐI TƯỢNG',2,50,4,'DCT1206','HAI',1,2,'E402','PHẠM HỒNG ANH',1,1480000,'CNTT',0,0),
('841044','LẬP TRÌNH HƯỚNG ĐỐI TƯỢNG',2,50,4,'DCT1206','BA',6,2,'A003','PHẠM HỒNG ANH',1,1480000,'CNTT',1,0),
('841109','CƠ SỞ DỮ LIỆU',2,50,4,'DCT1206','HAI',1,3,'E602','TRƯƠNG TẤN KHOA',1,1480000,'CNTT',0,0),
('841109','CƠ SỞ DỮ LIỆU',2,50,4,'DCT1206','TƯ',4,2,'A203','TRƯƠNG TẤN KHOA',1,1480000,'CNTT',1,0),
('841110','CƠ SỞ TRÍ TUỆ NHÂN TẠO',1,55,4,'DCT1206','SÁU',1,3,'E502','NGUYỄN TUẤN ĐĂNG',1,1480000,'CNTT',0,0),
('841110','CƠ SỞ TRÍ TUỆ NHÂN TẠO',1,55,4,'DCT1206','BA',6,2,'A103','NGUYỄN TUẤN ĐĂNG',1,1480000,'CNTT',1,0);

INSERT THONGTINCANHAN VALUES
('3120410412','Nguyễn Thiên Phúc','2002-03-02','66/2/5A Tôn Thất Thuyết P15 Q4','DCT1203','Kỹ thuật phần mềm','CNTT','2020-2025','../UploadedFile/Avatar/20220326_112243.jpg','serenata02',0);

INSERT INTO NIENKHOAHOCKY (HOCKY, TGBATDAU, TGKETTHUC, NIENKHOA, HPCHUAGIAM, HPMIENGIAM, HPPHAITHU, HPDATHU, HPCONNO) VALUES 
(2, curdate(),'2024-05-20','2024-2025',null,null,null, null, null),
(1,'2024-07-20','2024-12-07','2025-2026',null,null,null, null, null);

SELECT * FROM NIENKHOAHOCKY;
SELECT * FROM DIEM;
SELECT * FROM MONHOC, DIEM, THONGTINCANHAN WHERE MONHOC.MAMH=DIEM.MAMH AND THONGTINCANHAN.MASO=DIEM.MASO AND DIEM.MASO = '3120410412';
drop database sguedu;

